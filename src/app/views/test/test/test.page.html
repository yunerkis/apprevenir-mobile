<form class="test-form" [formGroup]="formGroup">
  <mat-horizontal-stepper linear #stepper formArrayName="formArray">
      <mat-step formGroupName="{{i}}" [stepControl]="formArray?.get([i])" *ngFor="let question of questions; let i = index">
        <div class="test-form__label">
          <div class="test-form__order">
            {{ question.order }}
          </div>
          <div class="test-form__question">
            {{ question.question }}
          </div>
        </div>
        <div class="test-form__input">
          <mat-radio-group formControlName="addiction" required class="test__radio-flex" 
            *ngIf="question.order == 1 && test['name'] == 'Drogas'" (change)="selectAddiction($event)">
            <mat-radio-button value="{{ in }}" *ngFor="let addiction of test.addictions; let in = index">
              <label class="test__label">{{ order[in] }}</label>
              <div class="test-form__option-answer">{{ addiction.description }}</div>
            </mat-radio-button>
          </mat-radio-group>
          <div *ngIf="question.order != 1 && test['name'] == 'Drogas'" class="test-form__addiction">
            <label class="test__label">{{ order[0] }}</label>
            <div class="test-form__option-answer">{{ addictionDesc }}</div>
          </div>
          
          <mat-form-field class="example-full-width" *ngIf="question.order != 1 && test['name'] == 'Drogas'">
            <mat-label>Elige una opci√≥n</mat-label>
            <mat-select formControlName="answer_{{i}}" required >
              <mat-option [value]="answer.id"  *ngFor="let answer of question.answers; let in = index" >
                {{ answer.answer }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-radio-group formControlName="answer_{{i}}" required class="test__radio-flex" 
            *ngIf="test['name'] != 'Drogas'">
            <mat-radio-button value="{{ answer.id }}" *ngFor="let answer of question.answers; let in = index">
              <label class="test__label">{{ order[in] }}</label>
              <div class="test-form__option-answer">{{ answer.answer }}</div>
            </mat-radio-button>
          </mat-radio-group>
        </div>
        <div class="test-form__content-btns">
          <a *ngIf="i == 0" [routerLink]="['/home']"><button class="test-form__btn back" mat-button>Atras</button></a>
          <button *ngIf="i != 0" class="test-form__btn back" mat-button matStepperPrevious>Atras</button>
          <button *ngIf="i != questions.length - 1" class="test-form__btn next" mat-button matStepperNext> Siguiente</button>
          <button *ngIf="i == questions.length - 1" class="test-form__btn next" mat-button matStepperNext (click)="onSubmit()">Enviar</button>
        </div>
      </mat-step>
  </mat-horizontal-stepper>
</form>

